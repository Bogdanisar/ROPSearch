<?xml version="1.0"?>
<!--
This is a configuration file used for building Gadget Moulds at run-time.
Note: This gadget catalog configuration uses Instruction Sequences
      that correspond to those that we have in "hardcodedGadgets64bit.c" / "vulnerableHelped.exe"
-->
<catalog>
    <gadget name="AssignConstant">
        <!--
            Each gadget could be expressed in different ways,
            according to what instruction sequences are available.
            Each "variant" is one such valid instantiation. Each gadget needs at least one variant.
        -->
        <variant>
            <stack stack-top="last">
                <!-- 'size' is the number of bytes -->
                <arg name="const" size="8"></arg>
                <arg name="dest" size="8"></arg>
                <insSeq syntax="att">
                    pop %rax;
                    pop %rbx;
                    mov %rbx, (%rax);
                    ret;
                </insSeq>
            </stack>
        </variant>
    </gadget>
    <gadget name="AssignVarToVar">
        <variant>
            <stack stack-top="last">
                <arg name="dest" size="8"></arg>
                <arg name="src" size="8"></arg>
                <insSeq syntax="att">
                    pop %rax;
                    pop %rbx;
                    mov (%rax), %rax;
                    mov %rax, (%rbx);
                    ret;
                </insSeq>
            </stack>
        </variant>
    </gadget>
    <gadget name="storePointerDereferenceIntoVariable">
        <variant>
            <stack stack-top="last">
                <arg name="dest" size="8"></arg>
                <arg name="ptrSource" size="8"></arg>
                <insSeq syntax="att">
                    pop %rax;
                    pop %rbx;
                    mov (%rax), %rax;
                    mov (%rax), %rax;
                    mov %rax, (%rbx);
                    ret;
                </insSeq>
            </stack>
        </variant>
    </gadget>
    <gadget name="storeVariableIntoPointerDereference">
        <variant>
            <stack stack-top="last">
                <arg name="src" size="8"></arg>
                <arg name="ptrDest" size="8"></arg>
                <insSeq syntax="att">
                    pop %rax;
                    pop %rbx;
                    mov (%rax), %rax;
                    mov (%rbx), %rbx;
                    mov %rbx, (%rax);
                    ret;
                </insSeq>
            </stack>
        </variant>
    </gadget>
</catalog>